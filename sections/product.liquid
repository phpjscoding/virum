<!-- Structured Data (JSON-LD) -->
{% render json_ld.liquid,product:product %}
<style>
  /* Skip-to-content link for keyboard users */
  .skip-link {
    position: absolute;
    top: -9999px;
    left: -9999px;
    z-index: 999;
    background: #18181b;
    color: #fff;
    padding: 0.5rem 1rem;
    font-size: 0.75rem;
    font-weight: 700;
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }
  .skip-link:focus {
    top: 1rem;
    left: 1rem;
  }
  /* Focus ring */
  :focus-visible {
    outline: 2px solid #18181b;
    outline-offset: 3px;
  }
  /* Visually hidden utility */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }
</style>

<a href="#main-content" class="skip-link">Skip to main content</a>
<div class="max-w-7xl mx-auto px-4 md:px-8" style="margin-top:2em">
  <nav
    aria-label="Breadcrumb"
    class="flex items-center space-x-2 text-[10px] font-bold tracking-widest uppercase text-zinc-400 mb-12"
  >
    <ol class="flex items-center space-x-2" itemscope itemtype="https://schema.org/BreadcrumbList">
      <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a href="{{ routes.root_url }}" itemprop="item" class="hover:text-zinc-900 transition-colors">
          <span itemprop="name">Home</span>
        </a>
        <meta itemprop="position" content="1">
      </li>

      <!-- Separator -->
      <li aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" focusable="false">
          <path d="m9 18 6-6-6-6"/>
        </svg>
      </li>

      <!-- Collection (uses current context if from collection, else first collection) -->
      {% assign bc_collection = collection %}
      {% unless bc_collection.handle %}
        {% assign bc_collection = product.collections.first %}
      {% endunless %}

      {% if bc_collection.handle and bc_collection.handle != 'all' %}
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="{{ bc_collection.url }}" itemprop="item" class="hover:text-zinc-900 transition-colors">
            <span itemprop="name">{{ bc_collection.title | escape }}</span>
          </a>
          <meta itemprop="position" content="2">
        </li>

        <!-- Separator -->
        <li aria-hidden="true">
          <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" focusable="false">
            <path d="m9 18 6-6-6-6"/>
          </svg>
        </li>
      {% endif %}

      <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <span itemprop="name" aria-current="page" class="text-zinc-900">
          {{ product.title | escape }}
        </span>
        <meta itemprop="position" content="3">
      </li>
    </ol>
  </nav>

  <div id="main-content">
    <section aria-label="Product details" class="grid grid-cols-1 lg:grid-cols-12 gap-16 mb-24">
      <!-- Product Gallery -->
      <div class="lg:col-span-7 space-y-4">
        {% assign current_variant = product.selected_or_first_available_variant %}

        <!-- Main product image -->
        <figure class="aspect-[4/5] bg-zinc-50 overflow-hidden relative group m-0">
          {% if current_variant.featured_media %}
            <img
              src="{{ current_variant.featured_media | image_url: width: 800, height: 1000 }}"
              alt="{{ current_variant.alt | escape | default: product.title | escape }}"
              width="800"
              height="1000"
              class="w-full h-full object-cover"
              loading="eager"
              fetchpriority="high"
            >
          {% else %}
            <img
              src="{{ product.featured_media | image_url: width: 800, height: 1000 }}"
              alt="{{ product.title | escape }}"
              width="800"
              height="1000"
              class="w-full h-full object-cover"
              loading="eager"
              fetchpriority="high"
            >
          {% endif %}
        </figure>

        <!-- Thumbnail gallery -->
       
        {% render 'product-thumbnails',
          product: product,
          variant: current_variant,
          enable_variant_grouping: true
        %}
      </div>

      <!-- Product Info -->
      <div class="lg:col-span-5 flex flex-col">
        <!-- Category / Product Type -->
        <p class="text-zinc-400 text-[10px] tracking-widest uppercase font-bold mb-2">
          <a href="{{ product.collections.first.url | default: '/collections/all' }}" class="hover:text-zinc-700 transition-colors">
            {{ product.product_type | escape | default: product.collections.first.title }}
          </a>
        </p>

        <!-- Title -->
        <h1 class="text-4xl md:text-5xl lg:text-6xl text-zinc-900 mb-6 font-serif leading-tight">
          {{ product.title | escape }}
        </h1>

        <!-- Static rating example (make dynamic later with review app metafields) -->
        <div class="flex items-center gap-4 mb-8">
          <div aria-label="Rated 5 out of 5 stars" role="img" class="flex text-zinc-900">
            <!-- 5 stars (repeat SVG x5) -->
            {%- for i in (1..5) -%}
             <img
  src="{{ 'rating_star.svg' | asset_url }}"
  alt="rating star"
  loading="lazy"
  width="24"
  height="24"
/>            {%- endfor -%}
          </div>
          <a href="#reviews" class="text-[10px] font-bold tracking-widest uppercase text-zinc-400 hover:text-zinc-700 transition-colors">
            {{ product.metafields.reviews.rating_count | default: '0' }} Reviews
          </a>
        </div>

        <!-- Price -->
        <p class="text-3xl text-zinc-900 mb-8 font-light">
          <data value="{{ current_variant.price | divided_by: 100.0 }}">
            {{ current_variant.price | money }}
          </data>
        </p>

        <!-- Short description (use product description excerpt or metafield) -->
        <blockquote class="text-zinc-600 text-lg leading-relaxed mb-10 border-l-2 border-zinc-100 pl-6 italic">
          {{ product.description | strip_html | truncatewords: 35 }}
        </blockquote>

        <!-- Add to Bag Form -->
        <div class="space-y-8 mb-12">
          {% form 'product', product, class: 'product-form', id: 'product-form' %}
            <!-- Variant selector (dropdown example – replace with buttons/radios if needed) -->
            <fieldset class="border-0 p-0 m-0">
              <legend class="text-[10px] font-bold tracking-[0.3em] uppercase block mb-4">Variant</legend>
              <select name="id" class="w-full p-3 border border-zinc-300 rounded-md">
                {% for variant in product.variants %}
                  <option
                    value="{{ variant.id }}"
                    {% if variant == current_variant %}selected{% endif %}
                    data-price="{{ variant.price | money_without_currency }}"
                  >
                    {{ variant.title }}
                  </option>
                {% endfor %}
              </select>
            </fieldset>

            <!-- Quantity -->
            <div class="flex items-center gap-6 mt-6">
              <div role="spinbutton" aria-valuenow="1" aria-valuemin="1" aria-valuemax="99" aria-label="Quantity" class="flex items-center border border-zinc-200">
                <button type="button" aria-label="Decrease quantity" class="p-4 hover:bg-zinc-50 text-zinc-500 transition-colors js-decrease-qty">-</button>
                <input name="quantity" type="number" value="1" min="1" class="px-6 py-2 text-sm font-bold w-16 text-center border-x border-zinc-200" />
                <button type="button" aria-label="Increase quantity" class="p-4 hover:bg-zinc-50 text-zinc-500 transition-colors js-increase-qty">+</button>
              </div>

              <button
                type="submit"
                name="add"
                class="flex-1 bg-zinc-900 text-white py-4 font-bold tracking-[0.2em] uppercase text-xs hover:bg-zinc-800 transition-all flex items-center justify-center gap-3"
                aria-label="Add to bag"
              >
                Add to Bag
              </button>
            </div>
          {% endform %}
        </div>

        <!-- Secondary actions -->
        <div class="flex items-center justify-between py-6 border-y border-zinc-100 mb-12">
          <button type="button" class="flex items-center gap-2 text-[10px] font-bold tracking-widest uppercase text-zinc-500 hover:text-zinc-900 transition-colors">
            <!-- Heart SVG -->
            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5"/>
            </svg>
            Add to Wishlist
          </button>

          <button type="button" class="flex items-center gap-2 text-[10px] font-bold tracking-widest uppercase text-zinc-500 hover:text-zinc-900 transition-colors">
            <!-- Share SVG -->
            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/>
              <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
            </svg>
            Share Product
          </button>
        </div>

        <!-- Trust badges (static – can make dynamic later) -->
        <ul class="grid grid-cols-3 gap-4 list-none p-0 m-0" aria-label="Shipping and purchase assurances">
          <!-- Your 3 badge items remain the same -->
          <li class="text-center p-4 bg-zinc-50">
            <!-- Truck SVG -->
            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto mb-2 text-zinc-400">
              <path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"/><path d="M15 18H9"/><path d="M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14"/><circle cx="17" cy="18" r="2"/><circle cx="7" cy="18" r="2"/>
            </svg>
            <p class="text-[8px] font-bold tracking-widest uppercase">Safe Ship</p>
          </li>
          <!-- Add the other two badges similarly -->
        </ul>
      </div>
    </section>
  </div>
</div>
<!-- Tab interactivity -->
<script>
  const tabs = document.querySelectorAll('[role="tab"]');
  const panels = document.querySelectorAll('[role="tabpanel"]');

  tabs.forEach((tab) => {
    tab.addEventListener('click', () => {
      // Deselect all
      tabs.forEach((t) => {
        t.setAttribute('aria-selected', 'false');
        t.classList.remove('text-zinc-900');
        t.classList.add('text-zinc-400');
        const indicator = t.querySelector('span[aria-hidden]');
        if (indicator) indicator.remove();
      });
      panels.forEach((p) => p.setAttribute('hidden', ''));

      // Select clicked
      tab.setAttribute('aria-selected', 'true');
      tab.classList.add('text-zinc-900');
      tab.classList.remove('text-zinc-400');
      const indicator = document.createElement('span');
      indicator.setAttribute('aria-hidden', 'true');
      indicator.className = 'absolute bottom-0 left-0 right-0 h-0.5 bg-zinc-900';
      tab.appendChild(indicator);

      const panel = document.getElementById(tab.getAttribute('aria-controls'));
      panel.removeAttribute('hidden');
      panel.focus();
    });

    // Arrow-key navigation
    tab.addEventListener('keydown', (e) => {
      const idx = [...tabs].indexOf(tab);
      if (e.key === 'ArrowRight') {
        tabs[(idx + 1) % tabs.length].click();
        tabs[(idx + 1) % tabs.length].focus();
      }
      if (e.key === 'ArrowLeft') {
        tabs[(idx - 1 + tabs.length) % tabs.length].click();
        tabs[(idx - 1 + tabs.length) % tabs.length].focus();
      }
    });
  });

  // Quantity stepper
  const output = document.querySelector('output[aria-live]');
  const spinbutton = document.querySelector('[role="spinbutton"]');
  const [decBtn, incBtn] = spinbutton.querySelectorAll('button');
  let qty = 1;
  decBtn.addEventListener('click', () => {
    if (qty > 1) {
      qty--;
      output.textContent = qty;
      spinbutton.setAttribute('aria-valuenow', qty);
    }
  });
  incBtn.addEventListener('click', () => {
    if (qty < 99) {
      qty++;
      output.textContent = qty;
      spinbutton.setAttribute('aria-valuenow', qty);
    }
  });

  // Set-size radio style sync
  document.querySelectorAll('input[name="set-size"]').forEach((radio) => {
    radio.addEventListener('change', () => {
      document.querySelectorAll('input[name="set-size"]').forEach((r) => {
        const span = r.nextElementSibling;
        if (r.checked) {
          span.className = span.className.replace(
            'bg-white text-zinc-500 border-zinc-200',
            'bg-zinc-900 text-white border-zinc-900'
          );
        } else {
          span.className = span.className.replace(
            'bg-zinc-900 text-white border-zinc-900',
            'bg-white text-zinc-500 border-zinc-200'
          );
        }
      });
    });
  });
</script>

{% schema %}
{
  "name": "t:general.product",
  "settings": [],
  "disabled_on": {
    "groups": ["header", "footer"]
  }
}
{% endschema %}
