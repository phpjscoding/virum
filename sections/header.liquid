<header>
  {% comment %}
    <h2 class="header__title">
      {{ shop.name | link_to: routes.root_url }}
    </h2>

    <div class="header__menu">
      {% for link in section.settings.menu.links %}
        {{ link.title | link_to: link.url }}
      {% endfor %}
    </div>

    <div class="header__icons">
      {% if shop.customer_accounts_enabled %}
        {{ 'icon-account.svg' | inline_asset_content | link_to: routes.account_url }}
      {% endif %}

      <a href="{{ routes.cart_url }}">
        {% if cart.item_count > 0 %}
          <sup>{{ cart.item_count }}</sup>
        {% endif %}

        {{ 'icon-cart.svg' | inline_asset_content }}
      </a>
    </div>
  {% endcomment %}
  <style>
    .is-dropdown {
      visibility: hidden;
      opacity: 0;
      position: absolute;
      top: 100%;
      left: 0;
      width: 12rem;
      background-color: #ffffff;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      margin-top: 1rem;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      transition-property: all;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 150ms;
      border: 1px solid #f4f4f5;
    }

    .has-drowdown:hover .is-dropdown {
      visibility: visible;
      opacity: 1;
    }
    .has-drowdown:hover .is-dropdown > li {
      transition: all 0.3s ease-in-out;
    }
    .has-drowdown:hover .is-dropdown > li:hover a {
      font-weight: bold;
      color: #000;
    }
  </style>

  <nav class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-transparent py-5">
    <div class="max-w-7xl mx-auto px-4 md:px-8 flex items-center justify-between">
      <button class="lg:hidden p-2 -ml-2 text-zinc-800">
        {{ 'burgger-menu.svg' | inline_asset_content }}
      </button>
      <div class="flex-1 lg:flex-none">
        <button class="text-2xl md:text-3xl font-serif tracking-widest text-zinc-900 uppercase focus:outline-none">
          {{ shop.name }}
        </button>
      </div>

      <ul class="hidden lg:flex items-center space-x-10 text-sm font-medium uppercase tracking-widest text-zinc-600">
        {% assign selected_menu = section.settings.menu %}

        {% for link in section.settings.menu.links %}
          <li class="{% if link.links.size > 0 %} has-drowdown relative {% else %} hover:text-zinc-900 transition-colors uppercase tracking-widest {% endif %}">
            {% if link.links.size > 0 %}
              <button class="flex items-center gap-1 hover:text-zinc-900 transition-colors">
                {{ link.title }}
                {{ 'arrow-down.svg' | inline_asset_content }}
              </button>
            {% else %}
              <a href="" class="hover:text-zinc-900 transition-colors lowercase tracking-widest"> {{ link.title }}</a>
            {% endif %}
            {% if link.links.size > 0 %}
              <ul class="is-dropdown">
                {% for child_link in link.links %}
                  <li class="text-left hover:text-zinc-900">
                    <a href="{{ child_link.url }}">{{ child_link.title }}</a>
                  </li>
                {% endfor %}
              </ul>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
      <div class="flex items-center space-x-4 md:space-x-6 text-zinc-800">
        <button class="p-1 hover:text-zinc-500 transition-colors">
          {% if section.settings.search_icon != blank %}
            {{ section.settings.search_icon | image_url: width: 30 | image_tag }}
          {% else %}
            {{ 'search-icon.svg' | inline_asset_content }}
          {% endif %}
        </button>
        <button class="p-1 hover:text-zinc-500 transition-colors">
          {{ 'user-icon.svg' | inline_asset_content }}
        </button>
        <button class="p-1 hover:text-zinc-500 transition-colors relative">
          {{ 'cart-icon.svg' | inline_asset_content }}
          {% if cart.item_count > 0 %}
            <span class="absolute -top-1 -right-1 bg-zinc-900 text-white text-[10px] w-4 h-4 rounded-full flex items-center justify-center font-bold">
              {{ cart.item_count }}
            </span>
          {% endif %}
        </button>
      </div>
    </div>
  </nav>
</header>

{% stylesheet %}
  header {
    height: 5rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  header a {
    position: relative;
    text-decoration: none;
    color: var(--color-foreground);
  }
  header a sup {
    position: absolute;
    left: 100%;
    overflow: hidden;
    max-width: var(--page-margin);
  }
  header svg {
    width: 2rem;
  }
  header .header__menu,
  header .header__icons {
    display: flex;
    gap: 1rem;
  }
{% endstylesheet %}
{%- if request.page_type == 'index' -%}
  {% assign potential_action_target = request.origin | append: routes.search_url | append: '?q={search_term_string}' %}
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "WebSite",
      "name": {{ shop.name | json }},
      "potentialAction": {
        "@type": "SearchAction",
        "target": {{ potential_action_target | json }},
        "query-input": "required name=search_term_string"
      },
      "url": {{ request.origin | append: page.url | json }}
    }
  </script>
{%- endif -%}

{% schema %}
{
  "name": "t:general.header",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "label": "t:labels.menu"
    },
    { "type": "header", "content": "User icons" },
    {
      "type": "image_picker",
      "id": "search_icon",
      "label": "Search Icon"
    },
    {
      "type": "image_picker",
      "id": "user_icon",
      "label": "User Icon"
    },
    {
      "type": "image_picker",
      "id": "cart_icon",
      "label": "Cart Icon"
    }
  ],
  "blocks": [
    {
      "type": "@app"
    }
  ]
}
{% endschema %}
